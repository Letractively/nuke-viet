/*
Copyright (c) 2003-2011, CKSource - Frederico Knabben. All rights reserved.
For licensing, see LICENSE.html or http://ckeditor.com/license
*/

(function(){var a=['margin-top','margin-bottom','border-top-width','border-bottom-width','padding-top','padding-bottom'];function b(e){var f=0;for(var g=0,h=a.length;g<h;g++)f+=parseInt(e.getComputedStyle(a[g])||0,10)||0;return f;};function c(e){var f=0;f+=b(e);if(e.is('html'))f+=b(e.getDocument().getBody());return f;};function d(e){var f=e.getBody().getLast();if(!f||f.type!=CKEDITOR.NODE_ELEMENT||f.is('br')){f=CKEDITOR.dom.element.createFromHtml('<span>'+(CKEDITOR.env.webkit?'&nbsp;':'')+'</span>',e);e.getBody().append(f);f.isMarker=1;}var g=f.getDocumentPosition(e).y+f.$.offsetHeight;f.isMarker&&f.remove();return g;};CKEDITOR.plugins.add('autogrow',{init:function(e){var f=0,g=function(i){if(!i.window)return;var j=i.document,k=i.getResizable(1),l=j.getBody(),m=j.getDocumentElement(),n=k.$.offsetHeight,o,p=!CKEDITOR.env.ie9Compat&&j.$.compatMode=='BackCompat'?l:m,q=d(j),r=q-p.$.clientHeight+c(p);if(r){o=n+r;var s=i.config.autoGrow_minHeight,t=i.config.autoGrow_maxHeight;s==undefined&&(i.config.autoGrow_minHeight=s=200);if(s)o=Math.max(o,s);if(t)o=Math.min(o,t);if(o!=n){o=i.fire('autoGrow',{currentHeight:n,newHeight:o}).newHeight;k.setStyle('height',o+'px');i.fire('resize');setTimeout(function(){f=p.scrollHeight-l.offsetHeight;},0);}}};for(var h in {contentDom:1,key:1,selectionChange:1,insertElement:1})e.on(h,function(i){var j=e.getCommand('maximize');if(i.editor.mode=='wysiwyg'&&(!j||j.state!=CKEDITOR.TRISTATE_ON))setTimeout(function(){g(i.editor);},100);});}});})();
